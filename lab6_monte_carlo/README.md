# Лабораторна робота 6: Монте-Карло та випадкові процеси

## Мета роботи
Вивчити метод Монте-Карло та його застосування для моделювання випадкових процесів і обчислення інтегралів.

## Теоретичні відомості

### Метод Монте-Карло
Метод Монте-Карло - це клас обчислювальних алгоритмів, які покладаються на повторне випадкове семплування для отримання чисельних результатів.

### 1. Випадкове блукання (Random Walk)
Випадкове блукання - це математичний процес, що описує шлях, який складається з послідовності випадкових кроків.

В 2D випадковому блуканні:
- На кожному кроці обирається випадковий напрямок θ ∈ [0, 2π]
- Крок виконується у вибраному напрямку:
  ```
  x(t+1) = x(t) + cos(θ)
  y(t+1) = y(t) + sin(θ)
  ```

**Властивості:**
- Середня відстань від початку після n кроків: E[r] ∝ √n
- Розподіл кінцевих відстаней підпорядковується розподілу Релея

### 2. Оцінка числа π методом Монте-Карло
Метод заснований на геометричній ймовірності:

1. Генеруємо випадкові точки в квадраті [0,1] × [0,1]
2. Перевіряємо, чи потрапляє точка в чверть кола радіусом 1
3. Оцінка π:
   ```
   π ≈ 4 × (кількість точок в колі) / (загальна кількість точок)
   ```

**Похибка оцінки:**
- Зменшується пропорційно 1/√n, де n - кількість точок
- Для більшої точності потрібно більше семплів

### 3. Розподіл Релея
Розподіл Релея описує відстань від початку координат після 2D випадкового блукання:

```
f(r; σ) = (r/σ²) exp(-r²/(2σ²))
```

де σ² = n/2 для n кроків одиничної довжини.

## Структура програми

Програма містить 4 основні частини:

### 1. Клас `RandomWalk`
- Симуляція одного 2D випадкового блукання
- Візуалізація траєкторії
- Обчислення відстані від початку

### 2. Клас `MonteCarloPi`
- Генерація випадкових точок
- Оцінка числа π
- Візуалізація точок та кола

### 3. Клас `MultipleRandomWalks`
- Симуляція багатьох незалежних блукань
- Статистичний аналіз результатів
- Порівняння з теоретичним розподілом Релея

### 4. Функція `convergence_study()`
- Дослідження збіжності методу Монте-Карло
- Аналіз залежності похибки від кількості семплів

## Параметри симуляції

### Випадкове блукання
- Кількість кроків: 5000
- Розмір кроку: 1.0

### Оцінка π
- Кількість точок: 50,000
- Область: [0,1] × [0,1]

### Статистичний аналіз
- Кількість блукань: 500
- Кроків на блукання: 500

### Дослідження збіжності
- Розміри вибірок: [100, 500, 1000, 5000, 10000, 50000, 100000]

## Запуск програми

```bash
cd lab6_monte_carlo
python monte_carlo.py
```

## Результати

Програма створює 4 графіки:

1. **random_walk.png** - траєкторія випадкового блукання
   - Показує шлях частинки за 5000 кроків
   - Зелена точка - початок, червоний хрестик - кінець

2. **monte_carlo_pi.png** - візуалізація оцінки π
   - Сині точки - всередині кола
   - Червоні точки - зовні кола
   - Чорна лінія - межа чверті кола

3. **distance_distribution.png** - розподіл кінцевих відстаней
   - Гістограма спостережуваних відстаней
   - Червона крива - теоретичний розподіл Релея

4. **convergence_study.png** - аналіз збіжності
   - Лівий графік: оцінка π vs кількість семплів
   - Правий графік: похибка vs кількість семплів (log-log шкала)

## Очікувані результати

### Випадкове блукання
- Траєкторія виглядає хаотично
- Кінцева відстань приблизно √(кількість кроків)

### Оцінка π
- Оцінка π ≈ 3.14 (з невеликою похибкою)
- Більше точок → менша похибка

### Статистичний аналіз
- Розподіл відстаней відповідає розподілу Релея
- Середня відстань ≈ 20 для 500 кроків

### Збіжність
- Похибка зменшується як 1/√n
- На log-log графіку - пряма лінія зі нахилом -1/2

## Контрольні питання

1. Що таке метод Монте-Карло?
2. Як працює оцінка π методом Монте-Карло?
3. Чому використовується випадкове семплування?
4. Як залежить точність від кількості семплів?
5. Що таке розподіл Релея і де він виникає?
6. Яка асимптотична складність методу Монте-Карло?

## Практичні застосування

Метод Монте-Карло використовується в:
- Фізиці: статистична механіка, квантова механіка
- Фінансах: оцінка ризиків, ціноутворення опціонів
- Інженерії: аналіз надійності систем
- Машинному навчанні: MCMC sampling
- Комп'ютерній графіці: ray tracing

## Висновки

В даній лабораторній роботі:
- Реалізовано метод Монте-Карло для різних задач
- Змодельовано випадкове блукання в 2D просторі
- Обчислено число π з використанням геометричної ймовірності
- Проведено статистичний аналіз випадкових процесів
- Досліджено збіжність методу Монте-Карло
- Порівняно експериментальні результати з теоретичними

---
**Студент:** Казакова Вікторія  
**Група:** 34-9
